import"./el-popper-BDGooy4u.js";/* empty css                  *//* empty css                   */import{E as P,a as j}from"./el-form-item-BgjdVhXU.js";import{E as K}from"./el-button-CNPsJZr7.js";import{E as O,a as S}from"./el-col-BC_5rDGT.js";import{E as q}from"./el-input-DbVz-qNy.js";/* empty css               */import{E as X,a as z}from"./el-select-C2_VNSgr.js";import"./el-scrollbar-6H1TZwJZ.js";import{Q as G,h as W,r as d,E as $,z as w,o as i,c as C,w as r,a as t,f as _,F as b,x as g,e as Q,D as Z,A as H}from"./app-CFgijPJ9.js";import{E as V}from"./index-2XnZ98l4.js";import{E as J}from"./index-CuyebXB1.js";import"./index-Bj972BkU.js";import"./castArray---o2jS6O.js";import"./use-form-item-CtTg29sZ.js";import"./isEqual-CB-qJuSE.js";import"./_initCloneObject-BMYI3sUv.js";import"./typescript-Bp3YSIOJ.js";import"./event-HEVJa2N9.js";import"./index-DjMxVoyT.js";import"./index-7U4WfkqU.js";import"./scroll-Toyc_l0B.js";import"./debounce-g4xw4pMO.js";import"./index-CHQ3r0BM.js";import"./use-dialog-lqoLPJmw.js";const Re={__name:"FormRombel",props:{open:Boolean,selectedRombel:Object},emits:["close"],setup(R,{emit:U}){const n=G(),f=R,I=U,k=W(()=>f.open),c=d(!1);d("/img/tutwuri.png"),d(null);const E=d([]),a=d({tapel:"",pararel:"",kode:"",label:"",fase:"",tingkat:"",sekolah_id:"",guru_id:"",is_active:""}),A=e=>{let o={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},u="";for(var s of Object.keys(o)){var p=Math.floor(e/o[s]);e-=p*o[s],u+=s.repeat(p)}return u},D=async()=>{c.value=!0;let e=new FormData;a.value.sekolah_id=n.props.sekolahs[0].npsn,Object.keys(a.value).forEach(u=>{e.append(u,a.value[u])});let o=a.value.id?"dashboard.rombel.update":"dashboard.rombel.store";a.value.id&&e.append("_method","PUT"),Z.post(route(o),e,{onSuccess:u=>{V({title:"Info",message:"Data Rombel disimpan",type:"success"}),h()},onError:u=>{Object.keys(u).forEach(s=>{setTimeout(()=>{V({title:"Error",message:u[s],type:"error"})},500)}),c.value=!1}})},h=()=>{c.value=!1,I("close")},x=async()=>{H.post(route("dashboard.guru.show",{_query:{sekolah:n.props.auth.roles.includes("admin")?"all":n.props.sekolahs[0].id}})).then(e=>{E.value=e.data.gurus})},F=e=>parseInt(e)<=2?"A":parseInt(e)<=4?"B":"C";$(()=>a,(e,o)=>{a.value.pararel=e.value.pararel?e.value.pararel:/[a-zA-Z]/gi.test(e.value.kode.substring(-1))?e.value.kode.substring(-1):"0",a.value.kode=n.props.sekolahs[0].npsn+"-"+n.props.periode.tapel.kode+"-"+e.value.tingkat+(e.value.pararel=="0"||!e.value.pararel?"":e.value.pararel.toLocaleLowerCase()),a.value.label="Kelas "+A(e.value.tingkat)+(e.value.pararel=="0"?"":e.value.pararel.toUpperCase()),a.value.tapel=n.props.periode.tapel.kode,a.value.fase=F(e.value.tingkat)},{deep:!0}),w(()=>{f.selectedRombel!==null&&(a.value=f.selectedRombel),x()});const M=e=>["SATU","DUA","TIGA","EMPAT","LIMA","ENAM"][e-1];return(e,o)=>{const u=X,s=z,p=P,m=O,y=q,v=S,T=K,B=j,L=J;return i(),C(L,{modelValue:k.value,"onUpdate:modelValue":o[5]||(o[5]=l=>k.value=l),width:"800",title:"Formulir Data Rombel",onClose:h,draggable:""},{default:r(()=>[t(B,{"label-position":"top",size:"small"},{default:r(()=>[t(v,{gutter:6},{default:r(()=>[t(m,{span:4},{default:r(()=>[t(p,{label:"Tingkat"},{default:r(()=>[t(s,{modelValue:a.value.tingkat,"onUpdate:modelValue":o[0]||(o[0]=l=>a.value.tingkat=l),placeholder:"Pilih Tingkat",required:""},{default:r(()=>[(i(),_(b,null,g(6,l=>t(u,{key:l,value:l,label:M(l)},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(m,{span:4},{default:r(()=>[t(p,{label:"Pararel"},{default:r(()=>[t(s,{modelValue:a.value.pararel,"onUpdate:modelValue":o[1]||(o[1]=l=>a.value.pararel=l),placeholder:"Pilih Pararel",required:""},{default:r(()=>[(i(),_(b,null,g(["0","a","b","c","d"],l=>t(u,{key:l,value:l,label:l.toUpperCase()},null,8,["value","label"])),64))]),_:1},8,["modelValue"])]),_:1})]),_:1}),t(m,{span:8},{default:r(()=>[t(p,{label:"Nama Rombel"},{default:r(()=>[t(y,{modelValue:a.value.label,"onUpdate:modelValue":o[2]||(o[2]=l=>a.value.label=l),placeholder:"Nama Rombel",required:""},null,8,["modelValue"])]),_:1})]),_:1}),t(m,{span:8},{default:r(()=>[t(p,{label:"Kode Rombel"},{default:r(()=>[t(y,{modelValue:a.value.kode,"onUpdate:modelValue":o[3]||(o[3]=l=>a.value.kode=l),placeholder:"Kode Rombel",required:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(v,{gutter:6},{default:r(()=>[t(m,{span:12},{default:r(()=>[t(p,{label:"Wali Kelas"},{default:r(()=>[t(s,{modelValue:a.value.guru_id,"onUpdate:modelValue":o[4]||(o[4]=l=>a.value.guru_id=l),placeholder:"Wali Kelas",filterable:""},{default:r(()=>[(i(!0),_(b,null,g(E.value,(l,N)=>(i(),C(u,{key:N,value:l.id,label:`${l.nip}|${l.nama}`},null,8,["value","label"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(v,{justify:"center"},{default:r(()=>[t(T,{type:"primary",loading:c.value,onClick:D},{default:r(()=>o[6]||(o[6]=[Q("Simpan")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{Re as default};
