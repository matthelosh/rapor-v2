import"./el-popper-BxfQEJds.js";import{v as D}from"./el-loading-CK2Lw3BS.js";/* empty css                  *//* empty css                   *//* empty css                 */import{E as F,a as V}from"./el-table-column-BWckAC3N.js";import"./el-checkbox-DCFV4V_x.js";import"./el-scrollbar-fK2iBKQp.js";/* empty css               */import{E as N}from"./el-button-3Ip_9Urw.js";import{r as j,u as T}from"./xlsx-CBeNCG2-.js";import{Q as q,r as y,h as I,o as l,c as r,w as n,b as s,t as g,e as A,g as L,i as O,f as P,F as U,x as z,D as M}from"./app-BXsEN59A.js";import{E as v}from"./index-CyX1Qjlm.js";import{E as Q}from"./index-qK7aysDH.js";import{E as G}from"./index-OF6XvvP3.js";import"./index-CkGV8xCd.js";import"./index-C53zd3iQ.js";import"./isEqual-C0_ORWOq.js";import"./debounce-nv22URmW.js";import"./_initCloneObject-D1FE-Fs5.js";import"./use-form-item-C2hKDeat.js";import"./event-HEVJa2N9.js";import"./use-dialog-CFecfF9o.js";import"./scroll-Ca1Q_kqt.js";const H={class:"toolbar flex items-center justify-between"},J={class:"title"},K={class:"toolbar-items flex items-center"},R={class:"body"},W={class:"text-sky-800 text-xl"},xe={__name:"FormImpor",props:{open:Boolean,fields:Array,title:String,url:String,query:Object},emits:["close"],setup(h,{emit:x}){const f=q(),i=y(!1),a=h,p=x,_=I(()=>a.open),t=y([]),b=async o=>{const u=await o.target.files[0].arrayBuffer(),m=j(u),d=m.Sheets[m.SheetNames[0]];t.value=T.sheet_to_json(d)},k=async()=>{await M.post(route(a.url,{_query:a.query??null}),{sekolah:f.props.auth.roles[0]==="admin"?null:f.props.sekolahs[0].id,datas:t.value},{onStart:()=>i.value=!0,onSuccess:o=>{v({title:"Info",message:o.props.flash.message,type:"success"}),t.value=[],p("close")},onError:o=>{Object.keys(o).forEach(e=>{setTimeout(()=>{v({title:"Error",message:o[e],type:"error"})},500)})},onFinish:()=>{i.value=!1,p("close")}})},E=()=>{t.value=[],p("close")};return(o,e)=>{const u=N,m=F,d=V,w=Q,S=G,B=D;return l(),r(S,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=c=>_.value=c),onClose:E,fullscreen:!0},{header:n(()=>[s("div",H,[s("h3",J,"Impor Data "+g(a.title),1),s("div",K,[s("input",{type:"file",onChange:b,accept:".xlsx, .xls, .ods, .csv"},null,32),t.value.length>0?(l(),r(u,{key:0,type:"primary",onClick:k,loading:i.value},{default:n(()=>e[1]||(e[1]=[A("Simpan")])),_:1},8,["loading"])):L("",!0)])])]),default:n(()=>[s("div",R,[t.value.length>0?O((l(),r(d,{key:0,data:t.value,"max-height":"78vh",size:"small"},{default:n(()=>[(l(!0),P(U,null,z(a.fields,(c,C)=>(l(),r(m,{key:C,prop:c,label:c.toUpperCase()},null,8,["prop","label"]))),128))]),_:1},8,["data"])),[[B,i.value]]):(l(),r(w,{key:1,type:"success"},{default:n(()=>[e[2]||(e[2]=s("span",{class:"font-bold text-sky-600 text-xl"},"Pastikan File Excel dengan format kolom",-1)),s("span",W,g(a.fields),1)]),_:1}))])]),_:1},8,["modelValue"])}}};export{xe as default};
