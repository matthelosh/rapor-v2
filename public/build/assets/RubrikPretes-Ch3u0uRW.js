import"./el-popper-BxfQEJds.js";import{v as B}from"./el-loading-CK2Lw3BS.js";/* empty css                  *//* empty css                   */import{E as C,a as S}from"./el-table-column-BWckAC3N.js";import"./el-checkbox-DCFV4V_x.js";import"./el-scrollbar-fK2iBKQp.js";import"./el-input-BgdrZhfW.js";/* empty css               */import{E as D,a as P}from"./el-select-Br8TPRck.js";import{E as z}from"./el-button-3Ip_9Urw.js";import{I as T}from"./iconify-DoFYDNe_.js";import{r as _,z as U,o as d,c as b,w as a,b as p,t as $,a as o,u as q,e as A,i as F,f as J,F as L,x as O,A as v}from"./app-BXsEN59A.js";import{E as h}from"./index-CyX1Qjlm.js";import{E as R}from"./index-OF6XvvP3.js";import"./index-CkGV8xCd.js";import"./index-C53zd3iQ.js";import"./isEqual-C0_ORWOq.js";import"./debounce-nv22URmW.js";import"./_initCloneObject-D1FE-Fs5.js";import"./use-form-item-C2hKDeat.js";import"./event-HEVJa2N9.js";import"./typescript-Bp3YSIOJ.js";import"./index-ExjPFQwu.js";import"./index-BlNNTmKD.js";import"./scroll-Ca1Q_kqt.js";import"./castArray-COTUzLor.js";import"./use-dialog-CFecfF9o.js";const K={class:"toolbar flex items-center justify-between"},M={class:"content"},G={class:"flex justify-end"},je={__name:"RubrikPretes",props:{rombel:Object,jilids:Array},emits:["close"],setup(g,{emit:y}){const i=g,E=y,u=_(!1),c=_([]),s=_(!1),j=async()=>{let t=[];s.value=!0,v.post(route("dashboard.spn.pretes.siswa",{_query:{rombelId:i.rombel.kode}})).then(e=>{e.data.siswas.forEach(n=>{var l;t.push({nisn:n.nisn,nama:n.nama,jilid:((l=n.jilids[0])==null?void 0:l.id)??i.jilids.find(f=>f.juz==1).id}),c.value=t,s.value=!1})})},x=async t=>{s.value=!0,v.post(route("dashboard.spn.pretes.siswa.attach",{siswaId:t.nisn}),{data:t}).then(e=>{h({title:"Info",message:e.data.message,type:"success"}),s.value=!1})},V=async()=>{s.value=!0,v.post(route("dashboard.spn.pretes.siswa.attach-all",{_query:{rombelId:i.rombel.kode}}),{siswas:c.value}).then(t=>{h({title:"Info",message:t.data.message,type:"success"}),s.value=!1})};return U(()=>{u.value=i.rombel!==null,j()}),(t,e)=>{const n=z,l=C,f=D,k=P,w=S,N=R,I=B;return d(),b(N,{fullscreen:"","show-close":!1,modelValue:u.value,"onUpdate:modelValue":e[1]||(e[1]=r=>u.value=r)},{header:a(()=>[p("div",K,[p("h3",null,"Rubrik Pretes SPN Kelas "+$(i.rombel.label),1),o(n,{circle:"",type:"danger",onClick:e[0]||(e[0]=r=>E("close"))},{default:a(()=>[o(q(T),{icon:"mdi:close"})]),_:1})])]),footer:a(()=>[p("div",G,[o(n,{type:"primary",onClick:V},{default:a(()=>e[2]||(e[2]=[A("Simpan")])),_:1})])]),default:a(()=>[p("div",M,[F((d(),b(w,{data:c.value,height:"80vh","max-height":"80vh"},{default:a(()=>[o(l,{label:"No",type:"index",width:"50"}),o(l,{label:"NISN",prop:"nisn"}),o(l,{label:"Nama",prop:"nama"}),o(l,{label:"Jilid"},{default:a(({row:r})=>[o(k,{modelValue:r.jilid,"onUpdate:modelValue":m=>r.jilid=m,placeholder:"Pilih jilid",onChange:m=>x(r)},{default:a(()=>[(d(!0),J(L,null,O(i.jilids,m=>(d(),b(f,{value:m.id,label:`Jilid ${m.juz}`},null,8,["value","label"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1})]),_:1},8,["data"])),[[I,s.value]])])]),_:1},8,["modelValue"])}}};export{je as default};
