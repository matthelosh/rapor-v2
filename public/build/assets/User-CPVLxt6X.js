import"./el-popper-CaImQOyu.js";import{v as J}from"./el-loading-CwoIpuHC.js";/* empty css                  *//* empty css                   */import{E as K,a as q}from"./el-form-item-CkXmoQH5.js";/* empty css                */import{E as G,a as H}from"./el-table-column-BNGLBdhX.js";import"./el-checkbox-CwFy4y1C.js";import"./el-scrollbar-eSEge-wK.js";import"./el-popover-BvxHu4lO.js";import{E as M}from"./el-input-sz4wU1yw.js";/* empty css               */import{E as Q,a as W}from"./el-select-C4bmNPi_.js";import{E as X}from"./el-button-DYt1oPSe.js";import{I as c}from"./iconify--ESl54GR.js";import{r as y,h as Y,o as f,f as U,a as e,w as o,b as s,u as v,e as I,t as E,F as k,x as P,c as x,i as Z,D as V}from"./app-DSVmZEKi.js";import{E as S}from"./index-Bcw9lRsO.js";import{E as ee}from"./index-BTk7wLDx.js";import{E as le}from"./index-Cns6kdyt.js";import{E as ae}from"./index-BlbCqnu5.js";import"./index-CH2Tk2ta.js";import"./castArray-mnFg3Ne5.js";import"./use-form-item-DBlcTQiz.js";import"./isEqual-clAqURvA.js";import"./_initCloneObject-Dy11O6uP.js";import"./index-DqcSeyRI.js";import"./debounce-BQCk7hAm.js";import"./event-HEVJa2N9.js";import"./typescript-Bp3YSIOJ.js";import"./index-BPhvBLmT.js";import"./index-DILpBOml.js";import"./scroll-_juTpDpT.js";import"./use-dialog-C_dmPDPa.js";const oe={class:"flex items-center justify-between"},te={class:"toolbar-items flex items-center gap-2"},se={class:"body"},re={class:"flex items-center gap-1"},ne={class:"flex items-center justify-between py-4 h-full"},ie={class:"dialog-body p-4"},Je={__name:"User",props:{users:Array,roles:Array,permissions:Array},setup(B){const w=B,_=y(null),j=Y(()=>_.value?w.users.filter(n=>n.userable?n.userable.nama.toLowerCase().includes(_.value.toLowerCase()):n.name.toLowerCase().includes(_.value.toLowerCase())):w.users),g=y(!1),u=y(!1),r=y({}),m=y(!1),z=()=>{m.value=!0},D=()=>{m.value=!1},F=async()=>{V.post(route("dashboard.user.store"),r.value,{onStart:()=>u.value=!0,onSuccess:()=>{u.value=!1,V.reload({only:["users"]}),r.value={},m.value=!1},onError:n=>{Object.keys(n).forEach(l=>{setTimeout(()=>{S({title:"Error",message:n[l],type:"error"})},500)}),u.value=!1}})},L=async n=>{await V.post(route("dashboard.user.permission.assign"),n,{onStart:()=>u.value=!0,onSuccess:()=>{u.value=!1,V.reload({only:["users"]}),r.value={},m.value=!1},onError:l=>{Object.keys(l).forEach(d=>{setTimeout(()=>{S({title:"Error",message:l[d],type:"error"})},500)}),u.value=!1}})};return(n,l)=>{const d=M,p=X,i=G,C=Q,h=W,N=ee,T=H,O=le,b=K,A=q,R=ae,$=J;return f(),U(k,null,[e(O,{style:{"margin-bottom":"20px"}},{header:o(()=>[s("div",oe,[l[9]||(l[9]=s("h3",null,"Data Pengguna",-1)),s("div",te,[e(d,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=a=>_.value=a),placeholder:"Cari User",clearable:"",size:"small"},{suffix:o(()=>[e(v(c),{icon:"mdi:account-search"})]),_:1},8,["modelValue"]),e(p,{type:"primary",size:"small",onClick:z},{default:o(()=>l[8]||(l[8]=[I("Buat User")])),_:1})])])]),default:o(()=>[s("div",se,[e(T,{data:j.value,"max-height":"600"},{default:o(()=>[e(i,{label:"#",type:"index"}),e(i,{label:"Username",prop:"name"}),e(i,{label:"Email",prop:"email"}),e(i,{label:"Nama"},{default:o(a=>{var t;return[s("div",null,E((t=a.row.userable)==null?void 0:t.nama),1)]}),_:1}),e(i,{label:"Jabatan"},{default:o(a=>{var t;return[s("div",null,E((t=a.row.userable)==null?void 0:t.jabatan),1)]}),_:1}),e(i,{label:"Role"},{default:o(a=>[s("div",null,E(a.row.roles.map(t=>t.name)),1)]),_:1}),e(i,{label:"Permission"},{default:o(a=>[s("div",null,E(a.row.permissions.map(t=>t.name)),1)]),_:1}),e(i,{label:"Kontak"},{default:o(a=>{var t;return[s("div",null,E((t=a.row.userable)==null?void 0:t.hp),1)]}),_:1}),e(i,{label:"Opsi",fixed:"right"},{default:o(a=>[s("div",re,[e(N,{trigger:"click"},{reference:o(()=>[e(p,{circle:"",type:"primary",size:"small"},{default:o(()=>[e(v(c),{icon:"mdi:account-edit"})]),_:1})]),default:o(()=>[l[10]||(l[10]=s("h3",null,"Berikan Ijin",-1)),e(h,{modelValue:a.row.permissions,"onUpdate:modelValue":t=>a.row.permissions=t,filterable:"",multiple:"",onChange:t=>L(a.row)},{default:o(()=>[(f(!0),U(k,null,P(w.permissions,(t,ue)=>(f(),x(C,{value:t.name},null,8,["value"]))),256))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024),e(p,{circle:"",type:"warning",size:"small"},{default:o(()=>[e(v(c),{icon:"mdi:account-reactivate"})]),_:1}),e(p,{circle:"",type:"danger",size:"small"},{default:o(()=>[e(v(c),{icon:"mdi:account-cancel"})]),_:1})])]),_:1})]),_:1},8,["data"])])]),_:1}),e(R,{modelValue:m.value,"onUpdate:modelValue":l[7]||(l[7]=a=>m.value=a),style:{padding:"0"},"show-close":!1},{header:o(()=>[s("div",ne,[l[11]||(l[11]=s("h3",null,"Form User",-1)),e(p,{circle:"",type:"danger",onClick:D,size:"small"},{default:o(()=>[e(v(c),{icon:"mdi:close"})]),_:1})])]),default:o(()=>[s("div",ie,[Z((f(),x(A,{modelValue:r.value,"onUpdate:modelValue":l[6]||(l[6]=a=>r.value=a),"label-width":"180"},{default:o(()=>[e(b,{label:"Username"},{default:o(()=>[e(d,{modelValue:r.value.name,"onUpdate:modelValue":l[1]||(l[1]=a=>r.value.name=a),placeholder:"Isikan Username"},null,8,["modelValue"])]),_:1}),e(b,{label:"Email"},{default:o(()=>[e(d,{type:"email",modelValue:r.value.email,"onUpdate:modelValue":l[2]||(l[2]=a=>r.value.email=a),placeholder:"Isikan Email"},null,8,["modelValue"])]),_:1}),e(b,{label:"Password"},{default:o(()=>[e(d,{type:g.value?"text":"password",modelValue:r.value.password,"onUpdate:modelValue":l[4]||(l[4]=a=>r.value.password=a),placeholder:"Isikan Password"},{suffix:o(()=>[e(v(c),{icon:`mdi:${g.value?"eye-off":"eye"}`,onClick:l[3]||(l[3]=a=>g.value=!g.value),class:"hover:cursor-pointer"},null,8,["icon"])]),_:1},8,["type","modelValue"])]),_:1}),e(b,{label:"Role"},{default:o(()=>[e(h,{modelValue:r.value.role,"onUpdate:modelValue":l[5]||(l[5]=a=>r.value.role=a),placeholder:"Role Pengguna",filterable:""},{default:o(()=>[(f(!0),U(k,null,P(w.roles,(a,t)=>(f(),x(C,{key:t,value:a.name},null,8,["value"]))),128))]),_:1},8,["modelValue"])]),_:1}),e(b,null,{default:o(()=>[e(p,{type:"primary",onClick:F},{default:o(()=>l[12]||(l[12]=[I("Simpan")])),_:1})]),_:1})]),_:1},8,["modelValue"])),[[$,u.value]])])]),_:1},8,["modelValue"])],64)}}};export{Je as default};
