const __vite__fileDeps=["assets/FormImpor-DLreoPNQ.js","assets/el-popper-CaImQOyu.js","assets/app-DSVmZEKi.js","assets/app.css","assets/index-CH2Tk2ta.js","assets/el-popper.css","assets/el-loading-CwoIpuHC.js","assets/el-loading.css","assets/el-table-column-BNGLBdhX.js","assets/el-scrollbar-eSEge-wK.js","assets/el-scrollbar.css","assets/index-DqcSeyRI.js","assets/isEqual-clAqURvA.js","assets/debounce-BQCk7hAm.js","assets/el-checkbox-CwFy4y1C.js","assets/event-HEVJa2N9.js","assets/use-form-item-DBlcTQiz.js","assets/el-checkbox.css","assets/_initCloneObject-Dy11O6uP.js","assets/el-table-column.css","assets/el-button-DYt1oPSe.js","assets/el-button.css","assets/xlsx-CBeNCG2-.js","assets/index-Bcw9lRsO.js","assets/index-CBkGLcYb.js","assets/index-BlbCqnu5.js","assets/use-dialog-C_dmPDPa.js","assets/scroll-_juTpDpT.js","assets/el-dialog.css","assets/el-overlay.css","assets/el-alert.css","assets/el-tag.css","assets/SiswaDapodik-BfTyicrn.js","assets/el-form-item-CkXmoQH5.js","assets/castArray-mnFg3Ne5.js","assets/el-form-item.css","assets/el-input-sz4wU1yw.js","assets/typescript-Bp3YSIOJ.js","assets/index-BPhvBLmT.js","assets/el-input.css","assets/iconify--ESl54GR.js","assets/index-Cns6kdyt.js","assets/el-card.css","assets/FormSiswa-MTj1rUqJ.js","assets/el-date-picker-Dr6COwF6.js","assets/el-select-C4bmNPi_.js","assets/index-DILpBOml.js","assets/el-select.css","assets/el-date-picker.css","assets/el-col-CfwV9s1K.js","assets/el-col.css","assets/el-avatar-DQ7CxTIe.js","assets/el-avatar.css","assets/DashLayout-DZQtduZ9.js","assets/el-popover-BvxHu4lO.js","assets/el-popover.css","assets/el-divider-BV5q6UHO.js","assets/el-divider.css","assets/DashLayout.css","assets/FormOrtu-BcWHyrzU.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{Q as fa,r as k,h as ha,o as _,f as j,a,u as i,Z as wa,w as t,b as u,t as c,e as f,i as ka,c as v,g as C,F as N,x as va,y as D,D as g,_ as F}from"./app-DSVmZEKi.js";import{E as ya}from"./el-popper-CaImQOyu.js";import{v as ga}from"./el-loading-CwoIpuHC.js";import{E as ba}from"./el-pagination-T1Sk13in.js";import{E as Ea}from"./el-input-sz4wU1yw.js";/* empty css               */import{E as Ca,a as Sa}from"./el-select-C4bmNPi_.js";import"./el-scrollbar-eSEge-wK.js";import{E as xa,a as Ia}from"./el-table-column-BNGLBdhX.js";import"./el-checkbox-CwFy4y1C.js";import{f as Oa,_ as Aa,E as Da}from"./DashLayout-DZQtduZ9.js";import"./el-popover-BvxHu4lO.js";import{E as Fa,a as Ta}from"./el-button-DYt1oPSe.js";import{E as Va}from"./el-avatar-DQ7CxTIe.js";/* empty css                        */import{I as h}from"./iconify--ESl54GR.js";import"./lodash-HhYqUCts.js";import{u as S,w as P}from"./xlsx-CBeNCG2-.js";import{d as L}from"./dayjs.min-wV17aXPy.js";import"./id-CiefbxgE.js";import{E as ja}from"./index-Cns6kdyt.js";import{E as x}from"./index-Bcw9lRsO.js";import"./index-CH2Tk2ta.js";import"./typescript-Bp3YSIOJ.js";import"./isEqual-clAqURvA.js";import"./event-HEVJa2N9.js";import"./index-BPhvBLmT.js";import"./use-form-item-DBlcTQiz.js";import"./index-DILpBOml.js";import"./scroll-_juTpDpT.js";import"./debounce-BQCk7hAm.js";import"./index-DqcSeyRI.js";import"./castArray-mnFg3Ne5.js";import"./_initCloneObject-Dy11O6uP.js";import"./el-divider-BV5q6UHO.js";const $a={class:"font-semibold text-xl text-gray-800 leading-tight uppercase"},za={class:"page"},Ba={class:"card-toolbar flex items-center justify-between"},Na={class:"card-title flex items-center"},Pa={class:"uppercase"},La={class:"card-toolbar--items flex items-center justify-end px-2 md:w-[60%]"},Ua=["src"],Wa={key:0},Ra={class:"flex items-center gap-1"},qa={class:"w-full flex items-center justify-between"},Ie={__name:"Siswa",setup(Ya){L.locale("id");const p=fa(),w=k({show:!1,url:"",fields:[]}),U=D(()=>F(()=>import("./FormImpor-DLreoPNQ.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]))),W=D(()=>F(()=>import("./SiswaDapodik-BfTyicrn.js"),__vite__mapDeps([32,1,2,3,4,5,8,9,10,11,12,13,14,15,16,17,18,19,33,34,35,36,37,38,39,20,21,40,41,25,26,27,28,29,31,42]))),I=k(!1),R=D(()=>F(()=>import("./FormSiswa-MTj1rUqJ.js"),__vite__mapDeps([43,1,2,3,4,5,33,34,16,12,18,35,20,21,44,45,36,37,15,38,39,9,10,46,27,13,11,47,48,49,50,51,52,53,54,55,40,56,57,58,23,25,26,28,29,31]))),O=k(!1),q=D(()=>F(()=>import("./FormOrtu-BcWHyrzU.js"),__vite__mapDeps([59,1,2,3,4,5,33,34,16,12,18,35,36,37,15,38,39,45,9,10,46,27,13,11,47,49,50,20,21,40,23,41,25,26,28,29,42,31]))),T=k(null),b=ha(()=>p.props.siswas);k(!1);const Y=()=>{I.value=!1,E.value=null,g.reload({only:["siswas"]})},M=()=>{w.value={show:!1,title:"",fields:[],url:""},g.reload({only:["siswas"]})},K=k(["nisn","nis","nik","nama","jk","tempat_lahir","tanggal_lahir","alamat","rt","rw","desa","kecamatan","kode_pos","kabupaten","provinsi","hp","email","foto","agama","angkatan","sekolah_id"]),G=k(["nisn","nama","nik_ayah","nama_ayah","alamat_ayah","hp_ayah","nik_ibu","nama_ibu","hp_ibu","alamat_ibu","nik_wali","nama_wali","alamat_wali","alamat_wali"]),J=()=>{w.value={show:!0,url:"dashboard.siswa.impor",title:"Siswa",fields:K.value}},Q=()=>{w.value={show:!0,url:"dashboard.siswa.ortu.impor",query:{rombelId:p.props.rombels[0].kode},title:"Ortu",fields:G.value}},E=k(null),Z=m=>{E.value=m,I.value=!0},H=async m=>{g.delete(route("dashboard.siswa.destroy",{id:m}),{onSuccess:o=>{x({title:"Info",message:"Data Siswa dihapus",type:"success"})},onError:o=>{Object.keys(o).forEach(n=>{setTimeout(()=>{x({title:"Error",message:o[n],type:"error"})},500)})}})},$=async m=>{g.post(route("dashboard.siswa.account.add"),{id:m},{onSuccess:o=>{x({title:"Info",message:"Akun Berhasil dibuat",type:"success"})},onError:o=>{Object.keys(o).forEach(n=>{setTimeout(()=>{x({title:"Error",message:o[n],type:"error"})},500)})}})},X=(m,o)=>{o.status=m,g.put(route("dashboard.siswa.update"),o,{onSuccess:n=>{x({title:"Info",message:n.props.flash.message,type:"success"})},onError:n=>{Object.keys(n).forEach(l=>{setTimeout(()=>{x({title:"Error",message:n[l],type:"error"})},500)})}})},aa=m=>{E.value=m,O.value=!0},ea=()=>{E.value={},O.value=!1},ta=async()=>{let m=[{nisn:"",nis:"",nik:"",nama:"",jk:"",tempat_lahir:"",tanggal_lahir:"",alamat:"",rt:"",rw:"",desa:"",kecamatan:"",kode_pos:"",kabupaten:"",provinsi:"",hp:"",email:"",agama:"",angkatan:"",sekolah_id:""}];p.props.siswas&&p.props.siswas.length>0&&p.props.siswas.forEach(l=>{m.push({nisn:l.nisn,nis:l.nis,nik:l.nik,nama:l.nama,jk:l.jk,tempat_lahir:l.tempat_lahir,tanggal_lahir:l.tanggal_lahir,alamat:l.alamat,hp:l.hp,email:l.email,agama:l.agama,angkatan:l.angkatan,sekolah_id:l.sekolah_id})});const o=S.json_to_sheet(m),n=S.book_new();S.book_append_sheet(n,o,"SISWA"),P(n,"Format Impor Siswa "+p.props.sekolahs[0].nama+".xlsx")},oa=async()=>{let m=[];p.props.siswas&&p.props.siswas.length>0&&p.props.siswas.forEach(l=>{m.push({nisn:l.nisn,nama:l.nama,nama_ayah:l.ortus.map(s=>s.relasi=="Ayah"?s.nama:"")??"",alamat_ayah:l.ortus.map(s=>s.relasi=="Ayah"?s.alamat:"")??"",hp_ayah:l.ortus.map(s=>s.relasi=="Ayah"?s.hp:"")??"",nama_ibu:l.ortus.map(s=>s.relasi=="Ibu"?s.nama:"")??"",alamat_ibu:l.ortus.map(s=>s.relasi=="Ibu"?s.alamat:"")??"",hp_ibu:l.ortus.map(s=>s.relasi=="Ibu"?s.hp:"")??"",nama_wali:l.ortus.map(s=>s.relasi=="Wali"?s.nama:"")??"",alamat_wali:l.ortus.map(s=>s.relasi=="Wali"?s.alamat:"")??"",hp_wali:l.ortus.map(s=>s.relasi=="Wali"?s.hp:"")??""})});const o=S.json_to_sheet(m),n=S.book_new();S.book_append_sheet(n,o,"ORTU"),P(n,"Format Impor Ortu "+p.props.sekolahs[0].nama+".xlsx")},la=()=>!0,sa=m=>{g.visit(b.value.path+"?page="+m,{preserveState:!0})},na=async()=>{g.visit(b.value.path+"?q="+T.value,{preserveState:!0})},A=k(!1),ra=()=>{A.value=!1};return(m,o)=>{const n=Fa,l=Ta,s=Ea,d=xa,ia=Va,ma=Ca,ua=Sa,pa=ya,V=Da,da=Ia,ca=ba,_a=ga;return _(),j(N,null,[a(i(wa),{title:"Data Siswa"}),a(Aa,null,{header:t(()=>{var e;return[u("h2",$a,c(i(p).props.auth.roles[0]!=="admin"?(e=i(p).props.sekolahs[0])==null?void 0:e.nama:"Admin"),1)]}),default:t(()=>[u("div",za,[a(i(ja),null,{header:t(()=>[u("div",Ba,[u("div",Na,[u("span",Pa,"Data Siswa "+c(i(p).props.auth.roles[0]!=="admin"?"":"Semua Sekolah"),1)]),u("div",La,[a(l,{class:"hidden-sm-and-down",size:"small"},{default:t(()=>[a(n,{type:"success",onClick:oa},{default:t(()=>[a(i(h),{icon:"mdi:file-excel"}),o[3]||(o[3]=f(" Unduh Format "))]),_:1}),a(n,{type:"warning",onClick:Q},{default:t(()=>[a(i(h),{icon:"mdi:human-male-female-child"}),o[4]||(o[4]=f(" Impor Ortu "))]),_:1})]),_:1}),a(l,{class:"mx-2",size:"small"},{default:t(()=>[a(n,{type:"primary",onClick:o[0]||(o[0]=e=>I.value=!0)},{default:t(()=>[a(i(h),{icon:"mdi-plus"}),o[5]||(o[5]=f(" Baru "))]),_:1}),a(n,{type:"danger",onClick:o[1]||(o[1]=e=>A.value=!0)},{default:t(()=>[a(i(h),{icon:"mdi:web-sync"}),o[6]||(o[6]=f(" Impor Dapodik "))]),_:1}),a(n,{type:"success",onClick:ta,class:"hidden-sm-and-down"},{default:t(()=>[a(i(h),{icon:"mdi:file-excel-box"}),o[7]||(o[7]=f(" Unduh Format "))]),_:1}),a(n,{type:"warning",onClick:J,class:"hidden-sm-and-down"},{default:t(()=>[a(i(h),{icon:"mdi-file-excel"}),o[8]||(o[8]=f(" Impor "))]),_:1})]),_:1}),a(s,{modelValue:T.value,"onUpdate:modelValue":o[2]||(o[2]=e=>T.value=e),placeholder:"Cari Siswa Berdasarkan Nama",clearable:"",style:{width:"300px"},onChange:na,class:"hidden-sm-and-down",size:"small"},{suffix:t(()=>[a(i(h),{icon:"mdi:magnify"})]),_:1},8,["modelValue"])])])]),footer:t(()=>[u("div",qa,[u("p",null,"Total: "+c(b.value.total),1),a(ca,{total:b.value.total,layout:"prev,pager,next",background:"",onCurrentChange:sa},null,8,["total"])])]),default:t(()=>[ka((_(),v(da,{data:b.value.data,"max-height":"75vh"},{default:t(()=>[a(d,{label:"#",type:"index"}),i(p).props.auth.roles.includes("admin")?(_(),v(d,{key:0,label:"Sekolah"},{default:t(e=>{var r;return[u("div",null,c((r=e.row.sekolah)==null?void 0:r.nama),1)]}),_:1})):C("",!0),a(d,{label:"NISN"},{default:t(({row:e})=>[a(n,{type:"primary",text:"",onClick:r=>Z(e)},{default:t(()=>[f(c(e.nisn),1)]),_:2},1032,["onClick"])]),_:1}),a(d,{label:"Foto"},{default:t(e=>[a(ia,{src:e.row.foto,onError:la},{default:t(()=>[u("img",{src:i(Oa)(e.row)},null,8,Ua)]),_:2},1032,["src"])]),_:1}),a(d,{label:"Nama",prop:"nama"}),a(d,{label:"JK",prop:"jk"}),a(d,{label:"Tempat, Tanggal Lahir"},{default:t(e=>[f(c(e.row.tempat_lahir)+", "+c(i(L)(e.row.tanggal_lahir).locale("id").format("DD MMM YYYY")),1)]),_:1}),a(d,{label:"Kelas"},{default:t(e=>{var r;return[f(c((r=e.row.rombels[0])==null?void 0:r.label),1)]}),_:1}),a(d,{label:"Akun",width:"100"},{default:t(e=>{var r;return[f(c((r=e.row.user)==null?void 0:r.name),1)]}),_:1}),a(d,{label:"Angkatan",width:"100"},{default:t(e=>[f(c(e.row.angkatan),1)]),_:1}),a(d,{label:"Orang Tua"},{default:t(e=>{var r,z,B;return[u("div",null,[u("p",null," Ayah: "+c((r=e.row.ortus.filter(y=>y.relasi=="Ayah")[0])==null?void 0:r.nama),1),u("p",null," Ibu: "+c((z=e.row.ortus.filter(y=>y.relasi=="Ibu")[0])==null?void 0:z.nama),1),e.row.ortus.filter(y=>y.relasi=="Wali").length>0?(_(),j("p",Wa," Wali: "+c((B=e.row.ortus.filter(y=>y.relasi=="Wali")[0])==null?void 0:B.nama),1)):C("",!0)])]}),_:1}),a(d,{label:"Status",width:"130"},{default:t(e=>[a(ua,{modelValue:e.row.status,"onUpdate:modelValue":r=>e.row.status=r,size:"small",onChange:r=>X(r,e.row)},{default:t(()=>[(_(),j(N,null,va(["aktif","lulus","do","mutasi"],r=>a(ma,{key:r,value:r,label:r.toUpperCase()},null,8,["value","label"])),64))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:1}),a(d,{label:"Opsi",width:"100",fixed:"right"},{default:t(e=>[u("div",Ra,[a(pa,{content:`Ortu ${e.row.nama}`,placement:"left"},{default:t(()=>[a(n,{circle:"",type:"success",size:"small",onClick:r=>aa(e.row)},{default:t(()=>[a(i(h),{icon:"mdi:human-male-female-child"})]),_:2},1032,["onClick"])]),_:2},1032,["content"]),u("span",null,[e.row.user?(_(),v(V,{key:1,size:"small",title:`Reset Password ${e.row.nama}?`,onConfirm:r=>$(e.row.id)},{reference:t(()=>[a(n,{circle:"",type:"warning",size:"small"},{default:t(()=>[a(i(h),{icon:"mdi:account-reactivate"})]),_:1})]),_:2},1032,["title","onConfirm"])):(_(),v(V,{key:0,size:"small",title:`Buatkan akun untuk ${e.row.nama}?`,onConfirm:r=>$(e.row.id)},{reference:t(()=>[a(n,{circle:"",type:"primary",size:"small"},{default:t(()=>[a(i(h),{icon:"mdi:account-plus-outline"})]),_:1})]),_:2},1032,["title","onConfirm"]))]),a(V,{size:"small",title:`Yakin menghapus data ${e.row.nama}?`,onConfirm:r=>H(e.row.id)},{reference:t(()=>[a(n,{circle:"",type:"danger",size:"small"},{default:t(()=>[a(i(h),{icon:"mdi:delete"})]),_:1})]),_:2},1032,["title","onConfirm"])])]),_:1})]),_:1},8,["data"])),[[_a,!b.value]])]),_:1})]),I.value?(_(),v(i(R),{key:0,open:I.value,onClose:Y,selectedSiswa:E.value},null,8,["open","selectedSiswa"])):C("",!0),w.value.show?(_(),v(i(U),{key:1,open:w.value.show,onClose:M,fields:w.value.fields,url:w.value.url,query:w.value.query,title:w.value.title},null,8,["open","fields","url","query","title"])):C("",!0),O.value?(_(),v(i(q),{key:2,open:O.value,onClose:ea,siswa:E.value},null,8,["open","siswa"])):C("",!0),A.value?(_(),v(i(W),{key:3,show:A.value,onClose:ra},null,8,["show"])):C("",!0)]),_:1})],64)}}};export{Ie as default};
